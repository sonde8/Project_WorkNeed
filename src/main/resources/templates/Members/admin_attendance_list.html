<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>근태 요청 관리</title>
    <link rel="stylesheet" th:href="@{/css/admin_user_list.css}">

</head>
<body>

<div class="admin-header" th:if="${admin != null}">
    <span>관리자: <b th:text="${admin.adminName}">관리자</b></span>
    <form th:action="@{/logout}" method="post">
        <button type="submit" class="btn-secondary">로그아웃</button>
    </form>
</div>

<div class="admin-tabs">
    <a th:href="@{/admin/member/list}" class="btn-tab">직원 관리</a>
    <a th:href="@{/admin/attendance/list}" class="btn-tab active">근태 요청 관리</a>
    <a th:href="@{/admin/manage/list}" class="btn-tab ">관리자 설정</a>
    <a th:href="@{/admin/log/list}" class="btn-tab ">활동 로그</a>
</div>

<div class="admin-content">
    <h2>근태 수정 요청 (대기)</h2>

    <table>
        <thead>
        <tr>
            <th>요청 ID</th>
            <th>사용자 ID</th>
            <th>요청 내용</th>
            <th>요청일</th>
            <th>처리</th>
        </tr>
        </thead>

        <tbody>
        <tr th:each="req : ${requests}">
            <td th:text="${req.requestId}"></td>
            <td th:text="${req.userId}"></td>

            <td class="payload-cell">
                <span class="raw-json" style="display:none;" th:text="${req.requestPayload}"></span>
                <div class="parsed-display"></div>
            </td>

            <td th:text="${#temporals.format(req.requestCreatedAt, 'yyyy-MM-dd HH:mm')}"></td>

            <td>
                <button type="button" class="btn-primary"
                        th:attr="data-id=${req.requestId}"
                        onclick="approve(this)" style="padding: 5px 10px; cursor:pointer;">
                    승인
                </button>

                <button type="button" class="btn-secondary"
                        th:attr="data-id=${req.requestId}"
                        onclick="reject(this)" style="padding: 5px 10px; cursor:pointer; margin-left: 5px;">
                    반려
                </button>
            </td>
        </tr>
        <tr th:if="${#lists.isEmpty(requests)}">
            <td colspan="5" style="text-align: center; padding: 30px; color: #999;">대기 중인 요청이 없습니다.</td>
        </tr>
        </tbody>
    </table>
</div>

<script src="/js/admin_attendance_list.js"></script>
</body>
</html>