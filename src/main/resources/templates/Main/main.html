<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">

<head>
    <title th:text="${pageTitle}"> Î©îÏù∏ </title>

    <!-- ÌéòÏù¥ÏßÄ Ï†ÑÏö© CSS -->
    <th:block layout:fragment="head">
        <link rel="stylesheet" th:href="@{/css/main.css}">
        <link rel="stylesheet" th:href="@{/css/attendanceLeft.css}">
        <link rel="stylesheet" th:href="@{/css/main-kanban.css}">
        <link rel="stylesheet" th:href="@{/css/main-board.css}">

        <!-- ÎØ∏ÎãàÏ∫òÎ¶∞Îçî -->
        <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet"/>
        <link rel="stylesheet" th:href="@{/css/mini-calendar.css}">

        <!-- ÌöåÏùòÏã§ -->
        <link rel="stylesheet" th:href="@{/css/meetingroom.css}">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

    </th:block>
    <!-- Î°úÍ∑∏Ïù∏ Ï†ïÎ≥¥ JS Ï£ºÏûÖ -->
    <script th:inline="javascript">
        window.LOGIN_USER_ID = /*[[${session.user != null ? session.user.userId : null}]]*/ null;
        window.IS_ADMIN = /*[[${session.admin != null}]]*/ false;
    </script>



</head>

<body>

<div layout:fragment="content" class = "pageMain">

    <div class="mainPage">

        <!-- ÏôºÏ™Ω -->
        <section class = "leftPage">

            <!-- Ïò§Îäò ÎÇ†Ïßú -->
            <div class = "toDay" id="todayStart"
                 th:text="${today != null ? today : 'ÎÇ†Ïßú'}"> ÎÇ†Ïßú </div>

            <!-- ÌîÑÎ°úÌïÑ -->
            <div class = "profile-card">

                <div class="profileImg">
                    <img th:if="${session.user.userProfileImage != null}"
                         th:src="${session.user.userProfileImage}"
                         alt="ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ">

                    <img th:unless="${session.user.userProfileImage != null}"
                         th:src="@{/images/default-profile.svg}"
                         alt="Í∏∞Î≥∏ÌîÑÎ°úÌïÑ"
                         class="profile">
                </div>

                <div class="profileText">
                    <div class="name" th:text="${user.userName}">ÏÇ¨Ïö©ÏûêÎ™Ö</div>

                    <div class="profileMeta">
                        <span class="dept" th:text="${user.deptName}">Î∂ÄÏÑúÎ™Ö</span>
                        <span class="bar">|</span>
                        <span class="rank" th:text="${user.rankName}">ÏßÅÍ∏â</span>
                    </div>
                </div>

            </div>

            <!-- Í∑ºÌÉúÍ¥ÄÎ¶¨ -->
            <a class="attendancePage" th:href="@{/attendance}"> Í∑º ÌÉú Í¥Ä Î¶¨ üëâ </a>

            <!-- Ï∂ú Ìá¥Í∑º -->
            <div class = "attendWidget">
                <section th:replace="~{Attendance/attendanceLeft :: attendanceLeft}"></section>
            </div>

            <!-- Í≤∞Ï†ú -->
            <div class="main-kpi-approval">
                <a class="kpi" th:href="@{/approval/inbox/waiting}">
                    <span class="kpi-num" th:text="${counts.approverTodoCount}">0</span>  <!-- Ïó¨Í∏∞ -->
                    <span class="kpi-label">ÎåÄÍ∏∞</span>
                </a>

                <a class="kpi" th:href="@{/approval/inbox/done}">
                    <span class="kpi-num" th:text="${counts.approverDoneCount}">0</span>
                    <span class="kpi-label">ÏôÑÎ£å</span>
                </a>

                <a class="kpi" th:href="@{/approval/my/drafts}">
                    <span class="kpi-num" th:text="${counts.drafterDraftCount}">0</span>
                    <span class="kpi-label">ÏûÑÏãú</span>
                </a>

                <a class="kpi" th:href="@{/approval/my/in-progress}">
                    <span class="kpi-num" th:text="${counts.drafterInProgressCount}">0</span>
                    <span class="kpi-label">ÏßÑÌñâ</span>
                </a>

                <a class="kpi" th:href="@{/approval/my/approved}">
                    <span class="kpi-num" th:text="${counts.drafterApprovedCount}">0</span>
                    <span class="kpi-label">ÏäπÏù∏</span>
                </a>

                <a class="kpi kpi--danger" th:href="@{/approval/my/rejected}">
                    <span class="kpi-num" th:text="${counts.drafterRejectedCount}">0</span>
                    <span class="kpi-label">Î∞òÎ†§</span>
                </a>
            </div>
        </section>

        <!-- Ïò§Î•∏Ï™Ω-->
        <section class = "rightPage">
            <!--Í≤åÏãúÌåê           -->
            <div class="main-borad">
                <div class="mini-borad">
                    <div class="mb-header">
                        <h3 class="mb-head">Í≤åÏãúÌåê</h3>
                        <button class="mb-write-btn" id="boardWriteBtn">+ ÏûëÏÑ±</button>
                    </div>

                    <ul class="mb-list" id="boardList">
                        <!-- JSÎ°ú Í≤åÏãúÍ∏Ä Î†åÎçîÎßÅ -->
                    </ul>
                </div>

                <!-- Í≤åÏãúÍ∏Ä Î™®Îã¨ -->
                <div class="board-modal" id="boardDetailModal" style="display:none;">
                    <div class="board-modal-panel">
                        <div class="board-modal-header">
                            <h4 id="detailTitle"></h4>
                            <button class="modal-close" data-close="detail">√ó</button>
                        </div>
                        <div class="modal-meta">
                            <span id="detailWriter"></span>
                            <span id="detailDate"></span>
                        </div>
                        <div class="board-modal-content" id="detailContent"></div>
                        <button type="button" id="detailDeleteBtn" style="display:none;">ÏÇ≠Ï†ú</button>
                    </div>
                </div>

                <!-- Í≤åÏãúÍ∏Ä ÏûëÏÑ± Î™®Îã¨ -->
                <div class="board-modal" id="boardWriteModal" style="display:none;">
                    <div class="board-modal-panel">
                        <div class="board-modal-header">
                            <h4>Í≤åÏãúÍ∏Ä ÏûëÏÑ±</h4>
                            <button class="modal-close" data-close="write">√ó</button>
                        </div>

                        <div class="modal-sheet">
                            <select id="writeCategory"><!-- Ïπ¥ÌÖåÍ≥†Î¶¨ JS Î°úÎî© --> </select>

                            <input type="text" id="writeTitle" placeholder="Title">

                            <textarea id="writeContent" placeholder="Content"></textarea>
                        </div>
                        <div class="modal-actions">
                            <button id="writeSubmitBtn">Îì±Î°ù</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ÎØ∏ÎãàÏ∫òÎ¶∞Îçî -->
            <div class="mini-calendar">
                <div id="miniCalendar" class="mini-calendar-wrapper"></div>
                <div id="miniCalendarTooltip"></div>
            </div>


            <div class="mini-kanban">
                <div th:replace="~{Main/main-kanban :: miniKanban}"></div>
            </div>

            <!-- ÌöåÏùòÏã§ -->
            <div class="mini-meetingroom">

                <input type="hidden" id="currentUserId" th:value="${user.userId}">

                <div class="meetingroom-header">
                    <h3>ÌöåÏùòÏã§ ÏòàÏïΩ</h3>
                    <div class="header-filters">
                        <div class="picker-wrapper">
                            <input type="text" id="statusDatePicker" class="picker-input date-picker">
                        </div>
                        <div class="picker-wrapper">
                            <input type="text" id="statusTimePicker" class="picker-input time-picker">
                        </div>
                    </div>
                </div>

                <div id="meeting-room-list" class="room-list-container">
                </div>
            </div>
        </section>
    </div>

    <div id="reservationModal" class="modal hidden">
        <div class="modal-content">
            <h3>ÌöåÏùòÏã§ ÏòàÏïΩ</h3>
            <form id="reservationForm">
                <label>ÏóÖÎ¨¥ (ÏÑ†ÌÉùÏÇ¨Ìï≠)</label>
                <select id="scheduleSelect" name="scheduleId">
                    <option value="">ÏóÖÎ¨¥ ÏÑ†ÌÉù Ïïà Ìï®</option>
                </select>

                <label>ÌöåÏùòÏã§</label>
                <select id="roomSelect" name="roomId" required></select>

                <label>ÎÇ†Ïßú</label>
                <input type="text" id="reserveDate" name="date" required readonly>

                <label>ÏãúÏûë ÏãúÍ∞Ñ</label>
                <input type="text" id="startTime" name="startTime" required readonly>

                <label>Ï¢ÖÎ£å ÏãúÍ∞Ñ</label>
                <input type="text" id="endTime" name="endTime" required readonly>

                <div class="modal-actions">
                    <button type="submit">ÏòàÏïΩ</button>
                    <button type="button" id="closeModalBtn">Ï∑®ÏÜå</button>
                </div>
            </form>
        </div>
    </div>


</div>
<th:block layout:fragment="script">
    <script th:src="@{/js/main.js}"></script>
    <script th:src="@{/js/attendanceLeft.js}"></script>

    <script th:inline="javascript">
        // ÏÑúÎ≤Ñ(Controller)ÏóêÏÑú Î≥¥ÎÇ∏ googleCalendarApiKey Í∞íÏùÑ Ïó¨Í∏∞Ïóê Ï£ºÏûÖÌï©ÎãàÎã§.
        window.GOOGLE_CALENDAR_API_KEY = /*[[${googleCalendarApiKey}]]*/ '';
    </script>

    <script th:src="@{/js/board.js}"></script>

    <!-- ÎØ∏ÎãàÏ∫òÎ¶∞Îçî -->
    <script th:src="@{/js/mini-calendar.js}"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/google-calendar@6.1.11/index.global.min.js"></script>

    <!-- ÌöåÏùòÏã§ -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script th:src="@{/js/meetingroom-status.js}"></script>
    <script th:src="@{/js/meetingroom-reservation.js}"></script>
</th:block>
</body>
</html>