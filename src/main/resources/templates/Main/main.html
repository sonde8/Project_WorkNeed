<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">

<head>
    <title th:text="${pageTitle}"> 메인 </title>

    <!-- 페이지 전용 CSS -->
    <th:block layout:fragment="head">
        <link rel="stylesheet" th:href="@{/css/Main.css}">
        <link rel="stylesheet" th:href="@{/css/attendanceLeft.css}">
    </th:block>

    <th:block layout:fragment="script">
        <script th:src="@{/js/main.js}"></script>
        <script th:src="@{/js/board.js}"></script>
        <script th:src="@{/js/attendanceLeft.js}"></script>
    </th:block>

    <!--kanban css-->
    <link rel="stylesheet" th:href="@{/css/main-kanban.css}">
    <!--board css -->
    <link rel="stylesheet" th:href="@{/css/main-board.css}">
</head>

<body>

<div layout:fragment="content" class = "pageMain">

    <div class="mainPage">

        <!-- 왼쪽 -->
        <section class = "leftPage">

            <!-- 오늘 날짜 -->
            <div class = "toDay" id="todayStart"
                 th:text="${today != null ? today : '날짜'}"> 날짜 </div>

            <!-- 프로필 -->
            <div class = "profile-card">

                <div class="profileImg">
                    <img th:if="${session.user.userProfileImage != null}"
                         th:src="${session.user.userProfileImage}"
                         alt="프로필 이미지">

                    <img th:unless="${session.user.userProfileImage != null}"
                         th:src="@{/images/default-profile.svg}"
                         alt="기본프로필"
                         class="profile">
                </div>

                <div class="profileText">
                    <div class="name" th:text="${user.userName}">사용자명</div>

                    <div class="profileMeta">
                        <span class="dept" th:text="${user.deptName}">부서명</span>
                        <span class="bar">|</span>
                        <span class="rank" th:text="${user.rankName}">직급</span>
                    </div>
                </div>

            </div>

            <!-- 출 퇴근 -->
            <div class = "attendWidget">
                <section th:replace="~{Attendance/attendanceLeft :: attendanceLeft}"></section>
            </div>

            <!-- 결제 -->
            <div class="main-kpi-approval">
                <a class="kpi" th:href="@{/approval/inbox/waiting}">
                    <span class="kpi-num" th:text="${counts.approverTodoCount}">0</span>  <!-- 여기 -->
                    <span class="kpi-label">대기</span>
                </a>

                <a class="kpi" th:href="@{/approval/inbox/done}">
                    <span class="kpi-num" th:text="${counts.approverDoneCount}">0</span>
                    <span class="kpi-label">완료</span>
                </a>

                <a class="kpi" th:href="@{/approval/my/drafts}">
                    <span class="kpi-num" th:text="${counts.drafterDraftCount}">0</span>
                    <span class="kpi-label">임시</span>
                </a>

                <a class="kpi" th:href="@{/approval/my/in-progress}">
                    <span class="kpi-num" th:text="${counts.drafterInProgressCount}">0</span>
                    <span class="kpi-label">진행</span>
                </a>

                <a class="kpi" th:href="@{/approval/my/approved}">
                    <span class="kpi-num" th:text="${counts.drafterApprovedCount}">0</span>
                    <span class="kpi-label">승인</span>
                </a>

                <a class="kpi kpi--danger" th:href="@{/approval/my/rejected}">
                    <span class="kpi-num" th:text="${counts.drafterRejectedCount}">0</span>
                    <span class="kpi-label">반려</span>
                </a>
            </div>
        </section>

        <!-- 오른쪽-->
        <section class = "rightPage">
            <!--게시판           -->
            <div class="main-borad">
                <div class="mini-borad">
                    <div class="mb-header">
                        <h3 class="mb-head">게시판</h3>
                        <button class="mb-write-btn" id="boardWriteBtn">+ 작성</button>
                    </div>

                    <ul class="mb-list" id="boardList">
                        <!-- JS로 게시글 렌더링 -->
                    </ul>
                </div>

                <!-- 게시글 모달 -->
                <div class="modal" id="boardDetailModal" style="display:none;">
                    <div class="modal-panel">
                        <div class="modal-header">
                            <h4 id="detailTitle"></h4>
                            <button class="modal-close" data-close="detail">×</button>
                        </div>
                        <div class="modal-meta">
                            <span id="detailWriter"></span>
                            <span id="detailDate"></span>
                        </div>
                        <div class="modal-content" id="detailContent"></div>
                    </div>
                </div>

                <!-- 게시글 작성 모달 -->
                <div class="modal" id="boardWriteModal" style="display:none;">
                    <div class="modal-panel">
                        <div class="modal-header">
                            <h4>게시글 작성</h4>
                            <button class="modal-close" data-close="write">×</button>
                        </div>

                        <div class="modal-sheet">
                            <select id="writeCategory"><!-- 카테고리 JS 로딩 --> </select>

                            <input type="text" id="writeTitle" placeholder="Title">

                            <textarea id="writeContent" placeholder="Content"></textarea>
                        </div>
                        <div class="modal-actions">
                            <button id="writeSubmitBtn">등록</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mini-calendar">미니 캘린더</div>

            <div class="mini-kanban">
                <div th:replace="main/main-kanban :: miniKanban"></div>
            </div>

            <div class="mini-meetingroom">회의실</div>
        </section>
    </div>


</div>

</body>
</html>